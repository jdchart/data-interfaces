import{f as lt,a as ut}from"../chunks/2nd4cOeL.js";import{i as re}from"../chunks/BorxfLZj.js";import{o as ie}from"../chunks/BIKdY9KO.js";import{c as wt,b as me,d as Mt,h as nt,g as de,f as ge,P as E,a4 as pe,r as ve,i as ye,j as Vt,s as bt,e as ct,C as _e,aM as we,ax as jt,k as Me,aR as W,n as Nt,q as be,ap as Kt,Q,aK as Xt,G as ke,aS as xe,aT as ze,aU as Te,l as oe,p as ae,aV as kt,a as Se,aJ as Ee,m as Ne,I as ue,J as Ae,R as tt,O as J,M as se,ai as ot,K as ft,aW as Ie,$ as De,S as G,T as V}from"../chunks/BGMCiVOv.js";import{s as ht}from"../chunks/BcTKq6Ah.js";import{h as Pe}from"../chunks/BDnjr7Vn.js";import{s as Re}from"../chunks/Cbx9bKlz.js";import{p as mt,b as At}from"../chunks/CyiI0agj.js";import{b as Ce}from"../chunks/l_RTz4ho.js";import{S as Lt,r as $e,c as Ye,i as It,a as Ut,b as Xe,d as Bt,e as Fe,f as Ft,T as xt,g as zt}from"../chunks/CqFyTwbj.js";import"../chunks/DnDE5Ze9.js";import{g as qe}from"../chunks/Co2UhlhP.js";function Tt(t,e){return e}function Oe(t,e,n){for(var r=[],s=e.length,l,a=e.length,u=0;u<s;u++){let m=e[u];ae(m,()=>{if(l){if(l.pending.delete(m),l.done.add(m),l.pending.size===0){var p=t.outrogroups;Dt(Xt(l.done)),p.delete(l),p.size===0&&(t.outrogroups=null)}}else a-=1},!1)}if(a===0){var h=r.length===0&&n!==null;if(h){var o=n,y=o.parentNode;Ee(y),y.append(o),t.items.clear()}Dt(e,!h)}else l={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(l)}function Dt(t,e=!0){for(var n=0;n<t.length;n++)Ne(t[n],e)}var Gt;function St(t,e,n,r,s,l=null){var a=t,u=new Map;{var h=t;a=nt?Mt(de(h)):h.appendChild(wt())}nt&&ge();var o=null,y=pe(()=>{var S=n();return ke(S)?S:S==null?[]:Xt(S)}),m,p=!0;function T(){N.fallback=o,Ve(N,m,a,e,r),o!==null&&(m.length===0?(o.f&W)===0?oe(o):(o.f^=W,st(o,null,a)):ae(o,()=>{o=null}))}var g=me(()=>{m=E(y);var S=m.length;let v=!1;if(nt){var I=ve(a)===ye;I!==(S===0)&&(a=Vt(),Mt(a),bt(!1),v=!0)}for(var D=new Set,A=Me,M=be(),x=0;x<S;x+=1){nt&&ct.nodeType===_e&&ct.data===we&&(a=ct,v=!0,bt(!1));var P=m[x],C=r(P,x),$=p?null:u.get(C);$?($.v&&jt($.v,P),$.i&&jt($.i,x),M&&A.skipped_effects.delete($.e)):($=je(u,p?a:Gt??=wt(),P,C,x,s,e,n),p||($.e.f|=W),u.set(C,$)),D.add(C)}if(S===0&&l&&!o&&(p?o=Nt(()=>l(a)):(o=Nt(()=>l(Gt??=wt())),o.f|=W)),nt&&S>0&&Mt(Vt()),!p)if(M){for(const[F,k]of u)D.has(F)||A.skipped_effects.add(k.e);A.oncommit(T),A.ondiscard(()=>{})}else T();v&&bt(!0),E(y)}),N={effect:g,items:u,outrogroups:null,fallback:o};p=!1,nt&&(a=ct)}function Ve(t,e,n,r,s){var l=e.length,a=t.items,u=t.effect.first,h,o=null,y=[],m=[],p,T,g,N;for(N=0;N<l;N+=1){if(p=e[N],T=s(p,N),g=a.get(T).e,t.outrogroups!==null)for(const C of t.outrogroups)C.pending.delete(g),C.done.delete(g);if((g.f&W)!==0)if(g.f^=W,g===u)st(g,null,n);else{var S=o?o.next:u;g===t.effect.last&&(t.effect.last=g.prev),g.prev&&(g.prev.next=g.next),g.next&&(g.next.prev=g.prev),H(t,o,g),H(t,g,S),st(g,S,n),o=g,y=[],m=[],u=o.next;continue}if((g.f&kt)!==0&&oe(g),g!==u){if(h!==void 0&&h.has(g)){if(y.length<m.length){var v=m[0],I;o=v.prev;var D=y[0],A=y[y.length-1];for(I=0;I<y.length;I+=1)st(y[I],v,n);for(I=0;I<m.length;I+=1)h.delete(m[I]);H(t,D.prev,A.next),H(t,o,D),H(t,A,v),u=v,o=A,N-=1,y=[],m=[]}else h.delete(g),st(g,u,n),H(t,g.prev,g.next),H(t,g,o===null?t.effect.first:o.next),H(t,o,g),o=g;continue}for(y=[],m=[];u!==null&&u!==g;)(h??=new Set).add(u),m.push(u),u=u.next;if(u===null)continue}(g.f&W)===0&&y.push(g),o=g,u=g.next}if(t.outrogroups!==null){for(const C of t.outrogroups)C.pending.size===0&&(Dt(Xt(C.done)),t.outrogroups?.delete(C));t.outrogroups.size===0&&(t.outrogroups=null)}if(u!==null||h!==void 0){var M=[];if(h!==void 0)for(g of h)(g.f&kt)===0&&M.push(g);for(;u!==null;)(u.f&kt)===0&&u!==t.fallback&&M.push(u),u=u.next;var x=M.length;if(x>0){var P=l===0?n:null;Oe(t,M,P)}}}function je(t,e,n,r,s,l,a,u){var h=(a&xe)!==0?(a&ze)===0?Q(n,!1,!1):Kt(n):null,o=(a&Te)!==0?Kt(s):null;return{v:h,i:o,e:Nt(()=>(l(e,h??n,o??s,u),()=>{t.delete(r)}))}}function st(t,e,n){if(t.nodes)for(var r=t.nodes.start,s=t.nodes.end,l=e&&(e.f&W)===0?e.nodes.start:n;r!==null;){var a=Se(r);if(l.before(r),r===s)return;r=a}}function H(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}const Ke=!0,cr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ke},Symbol.toStringTag,{value:"Module"}));function pt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Le(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function le(t){let e,n,r;t.length!==2?(e=pt,n=(u,h)=>pt(t(u),h),r=(u,h)=>t(u)-h):(e=t===pt||t===Le?t:Ue,n=t,r=t);function s(u,h,o=0,y=u.length){if(o<y){if(e(h,h)!==0)return y;do{const m=o+y>>>1;n(u[m],h)<0?o=m+1:y=m}while(o<y)}return o}function l(u,h,o=0,y=u.length){if(o<y){if(e(h,h)!==0)return y;do{const m=o+y>>>1;n(u[m],h)<=0?o=m+1:y=m}while(o<y)}return o}function a(u,h,o=0,y=u.length){const m=s(u,h,o,y-1);return m>o&&r(u[m-1],h)>-r(u[m],h)?m-1:m}return{left:s,center:a,right:l}}function Ue(){return 0}function Be(t){return t===null?NaN:+t}const Ge=le(pt),He=Ge.right;le(Be).center;const Qe=Math.sqrt(50),We=Math.sqrt(10),Ze=Math.sqrt(2);function vt(t,e,n){const r=(e-t)/Math.max(0,n),s=Math.floor(Math.log10(r)),l=r/Math.pow(10,s),a=l>=Qe?10:l>=We?5:l>=Ze?2:1;let u,h,o;return s<0?(o=Math.pow(10,-s)/a,u=Math.round(t*o),h=Math.round(e*o),u/o<t&&++u,h/o>e&&--h,o=-o):(o=Math.pow(10,s)*a,u=Math.round(t/o),h=Math.round(e/o),u*o<t&&++u,h*o>e&&--h),h<u&&.5<=n&&n<2?vt(t,e,n*2):[u,h,o]}function Je(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[s,l,a]=r?vt(e,t,n):vt(t,e,n);if(!(l>=s))return[];const u=l-s+1,h=new Array(u);if(r)if(a<0)for(let o=0;o<u;++o)h[o]=(l-o)/-a;else for(let o=0;o<u;++o)h[o]=(l-o)*a;else if(a<0)for(let o=0;o<u;++o)h[o]=(s+o)/-a;else for(let o=0;o<u;++o)h[o]=(s+o)*a;return h}function Pt(t,e,n){return e=+e,t=+t,n=+n,vt(t,e,n)[2]}function tn(t,e,n){e=+e,t=+t,n=+n;const r=e<t,s=r?Pt(e,t,n):Pt(t,e,n);return(r?-1:1)*(s<0?1/-s:s)}function K(t){return typeof t=="string"?new Lt([[document.querySelector(t)]],[document.documentElement]):new Lt([[t]],$e)}function en(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Z(t,e){if(t=en(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}const Rt={capture:!0,passive:!1};function Ct(t){t.preventDefault(),t.stopImmediatePropagation()}function nn(t){var e=t.document.documentElement,n=K(t).on("dragstart.drag",Ct,Rt);"onselectstart"in e?n.on("selectstart.drag",Ct,Rt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function rn(t,e){var n=t.document.documentElement,r=K(t).on("dragstart.drag",null);e&&(r.on("click.drag",Ct,Rt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function on(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),s;return function(l){for(s=0;s<n;++s)r[s]=t[s]*(1-l)+e[s]*l;return r}}function an(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function un(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,s=new Array(r),l=new Array(n),a;for(a=0;a<r;++a)s[a]=qt(t[a],e[a]);for(;a<n;++a)l[a]=e[a];return function(u){for(a=0;a<r;++a)l[a]=s[a](u);return l}}function sn(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function ln(t,e){var n={},r={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?n[s]=qt(t[s],e[s]):r[s]=e[s];return function(l){for(s in n)r[s]=n[s](l);return r}}function qt(t,e){var n=typeof e,r;return e==null||n==="boolean"?Ye(e):(n==="number"?It:n==="string"?(r=Bt(e))?(e=r,Ut):Xe:e instanceof Bt?Ut:e instanceof Date?sn:an(e)?on:Array.isArray(e)?un:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ln:It)(t,e)}function cn(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var fn=1e-12;function Ht(t){return((t=Math.exp(t))+1/t)/2}function hn(t){return((t=Math.exp(t))-1/t)/2}function mn(t){return((t=Math.exp(2*t))-1)/(t+1)}const dn=(function t(e,n,r){function s(l,a){var u=l[0],h=l[1],o=l[2],y=a[0],m=a[1],p=a[2],T=y-u,g=m-h,N=T*T+g*g,S,v;if(N<fn)v=Math.log(p/o)/e,S=function(P){return[u+P*T,h+P*g,o*Math.exp(e*P*v)]};else{var I=Math.sqrt(N),D=(p*p-o*o+r*N)/(2*o*n*I),A=(p*p-o*o-r*N)/(2*p*n*I),M=Math.log(Math.sqrt(D*D+1)-D),x=Math.log(Math.sqrt(A*A+1)-A);v=(x-M)/e,S=function(P){var C=P*v,$=Ht(M),F=o/(n*I)*($*mn(e*C+M)-hn(M));return[u+F*T,h+F*g,o*$/Ht(e*C+M)]}}return S.duration=v*1e3*e/Math.SQRT2,S}return s.rho=function(l){var a=Math.max(.001,+l),u=a*a,h=u*u;return t(a,u,h)},s})(Math.SQRT2,2,4);function gn(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function yt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function it(t){return t=yt(Math.abs(t)),t?t[1]:NaN}function pn(t,e){return function(n,r){for(var s=n.length,l=[],a=0,u=t[0],h=0;s>0&&u>0&&(h+u+1>r&&(u=Math.max(1,r-h)),l.push(n.substring(s-=u,s+u)),!((h+=u+1)>r));)u=t[a=(a+1)%t.length];return l.reverse().join(e)}}function vn(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var yn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _t(t){if(!(e=yn.exec(t)))throw new Error("invalid format: "+t);var e;return new Ot({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}_t.prototype=Ot.prototype;function Ot(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ot.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _n(t){t:for(var e=t.length,n=1,r=-1,s;n<e;++n)switch(t[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(s+1):t}var ce;function wn(t,e){var n=yt(t,e);if(!n)return t+"";var r=n[0],s=n[1],l=s-(ce=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,a=r.length;return l===a?r:l>a?r+new Array(l-a+1).join("0"):l>0?r.slice(0,l)+"."+r.slice(l):"0."+new Array(1-l).join("0")+yt(t,Math.max(0,e+l-1))[0]}function Qt(t,e){var n=yt(t,e);if(!n)return t+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const Wt={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:gn,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Qt(t*100,e),r:Qt,s:wn,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Zt(t){return t}var Jt=Array.prototype.map,te=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Mn(t){var e=t.grouping===void 0||t.thousands===void 0?Zt:pn(Jt.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",l=t.numerals===void 0?Zt:vn(Jt.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"−":t.minus+"",h=t.nan===void 0?"NaN":t.nan+"";function o(m){m=_t(m);var p=m.fill,T=m.align,g=m.sign,N=m.symbol,S=m.zero,v=m.width,I=m.comma,D=m.precision,A=m.trim,M=m.type;M==="n"?(I=!0,M="g"):Wt[M]||(D===void 0&&(D=12),A=!0,M="g"),(S||p==="0"&&T==="=")&&(S=!0,p="0",T="=");var x=N==="$"?n:N==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",P=N==="$"?r:/[%p]/.test(M)?a:"",C=Wt[M],$=/[defgprs%]/.test(M);D=D===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,D)):Math.max(0,Math.min(20,D));function F(k){var q=x,Y=P,i,_,c;if(M==="c")Y=C(k)+Y,k="";else{k=+k;var w=k<0||1/k<0;if(k=isNaN(k)?h:C(Math.abs(k),D),A&&(k=_n(k)),w&&+k==0&&g!=="+"&&(w=!1),q=(w?g==="("?g:u:g==="-"||g==="("?"":g)+q,Y=(M==="s"?te[8+ce/3]:"")+Y+(w&&g==="("?")":""),$){for(i=-1,_=k.length;++i<_;)if(c=k.charCodeAt(i),48>c||c>57){Y=(c===46?s+k.slice(i+1):k.slice(i))+Y,k=k.slice(0,i);break}}}I&&!S&&(k=e(k,1/0));var f=q.length+k.length+Y.length,d=f<v?new Array(v-f+1).join(p):"";switch(I&&S&&(k=e(d+k,d.length?v-Y.length:1/0),d=""),T){case"<":k=q+k+Y+d;break;case"=":k=q+d+k+Y;break;case"^":k=d.slice(0,f=d.length>>1)+q+k+Y+d.slice(f);break;default:k=d+q+k+Y;break}return l(k)}return F.toString=function(){return m+""},F}function y(m,p){var T=o((m=_t(m),m.type="f",m)),g=Math.max(-8,Math.min(8,Math.floor(it(p)/3)))*3,N=Math.pow(10,-g),S=te[8+g/3];return function(v){return T(N*v)+S}}return{format:o,formatPrefix:y}}var dt,fe,he;bn({thousands:",",grouping:[3],currency:["$",""]});function bn(t){return dt=Mn(t),fe=dt.format,he=dt.formatPrefix,dt}function kn(t){return Math.max(0,-it(Math.abs(t)))}function xn(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(it(e)/3)))*3-it(Math.abs(t)))}function zn(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,it(e)-it(t))+1}function Tn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Sn(t){return function(){return t}}function En(t){return+t}var ee=[0,1];function rt(t){return t}function $t(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Sn(isNaN(e)?NaN:.5)}function Nn(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function An(t,e,n){var r=t[0],s=t[1],l=e[0],a=e[1];return s<r?(r=$t(s,r),l=n(a,l)):(r=$t(r,s),l=n(l,a)),function(u){return l(r(u))}}function In(t,e,n){var r=Math.min(t.length,e.length)-1,s=new Array(r),l=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)s[a]=$t(t[a],t[a+1]),l[a]=n(e[a],e[a+1]);return function(u){var h=He(t,u,1,r)-1;return l[h](s[h](u))}}function Dn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Pn(){var t=ee,e=ee,n=qt,r,s,l,a=rt,u,h,o;function y(){var p=Math.min(t.length,e.length);return a!==rt&&(a=Nn(t[0],t[p-1])),u=p>2?In:An,h=o=null,m}function m(p){return p==null||isNaN(p=+p)?l:(h||(h=u(t.map(r),e,n)))(r(a(p)))}return m.invert=function(p){return a(s((o||(o=u(e,t.map(r),It)))(p)))},m.domain=function(p){return arguments.length?(t=Array.from(p,En),y()):t.slice()},m.range=function(p){return arguments.length?(e=Array.from(p),y()):e.slice()},m.rangeRound=function(p){return e=Array.from(p),n=cn,y()},m.clamp=function(p){return arguments.length?(a=p?!0:rt,y()):a!==rt},m.interpolate=function(p){return arguments.length?(n=p,y()):n},m.unknown=function(p){return arguments.length?(l=p,m):l},function(p,T){return r=p,s=T,y()}}function Rn(){return Pn()(rt,rt)}function Cn(t,e,n,r){var s=tn(t,e,n),l;switch(r=_t(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(l=xn(s,a))&&(r.precision=l),he(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(l=zn(s,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=l-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(l=kn(s))&&(r.precision=l-(r.type==="%")*2);break}}return fe(r)}function $n(t){var e=t.domain;return t.ticks=function(n){var r=e();return Je(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var s=e();return Cn(s[0],s[s.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),s=0,l=r.length-1,a=r[s],u=r[l],h,o,y=10;for(u<a&&(o=a,a=u,u=o,o=s,s=l,l=o);y-- >0;){if(o=Pt(a,u,n),o===h)return r[s]=a,r[l]=u,e(r);if(o>0)a=Math.floor(a/o)*o,u=Math.ceil(u/o)*o;else if(o<0)a=Math.ceil(a*o)/o,u=Math.floor(u*o)/o;else break;h=o}return t},t}function Yt(){var t=Rn();return t.copy=function(){return Dn(t,Yt())},Tn.apply(t,arguments),$n(t)}function Yn(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Xn=Yn("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),gt=t=>()=>t;function Fn(t,{sourceEvent:e,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function Et(t){t.stopImmediatePropagation()}function at(t){t.preventDefault(),t.stopImmediatePropagation()}function qn(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function On(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function ne(){return this.__zoom||Ft}function Vn(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function jn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Kn(t,e,n){var r=t.invertX(e[0][0])-n[0][0],s=t.invertX(e[1][0])-n[1][0],l=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),a>l?(l+a)/2:Math.min(0,l)||Math.max(0,a))}function Ln(){var t=qn,e=On,n=Kn,r=Vn,s=jn,l=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],u=250,h=dn,o=Fe("start","zoom","end"),y,m,p,T=500,g=150,N=0,S=10;function v(i){i.property("__zoom",ne).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",F).filter(s).on("touchstart.zoom",k).on("touchmove.zoom",q).on("touchend.zoom touchcancel.zoom",Y).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(i,_,c,w){var f=i.selection?i.selection():i;f.property("__zoom",ne),i!==f?M(i,_,c,w):f.interrupt().each(function(){x(this,arguments).event(w).start().zoom(null,typeof _=="function"?_.apply(this,arguments):_).end()})},v.scaleBy=function(i,_,c,w){v.scaleTo(i,function(){var f=this.__zoom.k,d=typeof _=="function"?_.apply(this,arguments):_;return f*d},c,w)},v.scaleTo=function(i,_,c,w){v.transform(i,function(){var f=e.apply(this,arguments),d=this.__zoom,b=c==null?A(f):typeof c=="function"?c.apply(this,arguments):c,z=d.invert(b),R=typeof _=="function"?_.apply(this,arguments):_;return n(D(I(d,R),b,z),f,a)},c,w)},v.translateBy=function(i,_,c,w){v.transform(i,function(){return n(this.__zoom.translate(typeof _=="function"?_.apply(this,arguments):_,typeof c=="function"?c.apply(this,arguments):c),e.apply(this,arguments),a)},null,w)},v.translateTo=function(i,_,c,w,f){v.transform(i,function(){var d=e.apply(this,arguments),b=this.__zoom,z=w==null?A(d):typeof w=="function"?w.apply(this,arguments):w;return n(Ft.translate(z[0],z[1]).scale(b.k).translate(typeof _=="function"?-_.apply(this,arguments):-_,typeof c=="function"?-c.apply(this,arguments):-c),d,a)},w,f)};function I(i,_){return _=Math.max(l[0],Math.min(l[1],_)),_===i.k?i:new xt(_,i.x,i.y)}function D(i,_,c){var w=_[0]-c[0]*i.k,f=_[1]-c[1]*i.k;return w===i.x&&f===i.y?i:new xt(i.k,w,f)}function A(i){return[(+i[0][0]+ +i[1][0])/2,(+i[0][1]+ +i[1][1])/2]}function M(i,_,c,w){i.on("start.zoom",function(){x(this,arguments).event(w).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(w).end()}).tween("zoom",function(){var f=this,d=arguments,b=x(f,d).event(w),z=e.apply(f,d),R=c==null?A(z):typeof c=="function"?c.apply(f,d):c,L=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),X=f.__zoom,j=typeof _=="function"?_.apply(f,d):_,B=h(X.invert(R).concat(L/X.k),j.invert(R).concat(L/j.k));return function(O){if(O===1)O=j;else{var U=B(O),et=L/U[2];O=new xt(et,R[0]-U[0]*et,R[1]-U[1]*et)}b.zoom(null,O)}})}function x(i,_,c){return!c&&i.__zooming||new P(i,_)}function P(i,_){this.that=i,this.args=_,this.active=0,this.sourceEvent=null,this.extent=e.apply(i,_),this.taps=0}P.prototype={event:function(i){return i&&(this.sourceEvent=i),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(i,_){return this.mouse&&i!=="mouse"&&(this.mouse[1]=_.invert(this.mouse[0])),this.touch0&&i!=="touch"&&(this.touch0[1]=_.invert(this.touch0[0])),this.touch1&&i!=="touch"&&(this.touch1[1]=_.invert(this.touch1[0])),this.that.__zoom=_,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(i){var _=K(this.that).datum();o.call(i,this.that,new Fn(i,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:o}),_)}};function C(i,..._){if(!t.apply(this,arguments))return;var c=x(this,_).event(i),w=this.__zoom,f=Math.max(l[0],Math.min(l[1],w.k*Math.pow(2,r.apply(this,arguments)))),d=Z(i);if(c.wheel)(c.mouse[0][0]!==d[0]||c.mouse[0][1]!==d[1])&&(c.mouse[1]=w.invert(c.mouse[0]=d)),clearTimeout(c.wheel);else{if(w.k===f)return;c.mouse=[d,w.invert(d)],zt(this),c.start()}at(i),c.wheel=setTimeout(b,g),c.zoom("mouse",n(D(I(w,f),c.mouse[0],c.mouse[1]),c.extent,a));function b(){c.wheel=null,c.end()}}function $(i,..._){if(p||!t.apply(this,arguments))return;var c=i.currentTarget,w=x(this,_,!0).event(i),f=K(i.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",L,!0),d=Z(i,c),b=i.clientX,z=i.clientY;nn(i.view),Et(i),w.mouse=[d,this.__zoom.invert(d)],zt(this),w.start();function R(X){if(at(X),!w.moved){var j=X.clientX-b,B=X.clientY-z;w.moved=j*j+B*B>N}w.event(X).zoom("mouse",n(D(w.that.__zoom,w.mouse[0]=Z(X,c),w.mouse[1]),w.extent,a))}function L(X){f.on("mousemove.zoom mouseup.zoom",null),rn(X.view,w.moved),at(X),w.event(X).end()}}function F(i,..._){if(t.apply(this,arguments)){var c=this.__zoom,w=Z(i.changedTouches?i.changedTouches[0]:i,this),f=c.invert(w),d=c.k*(i.shiftKey?.5:2),b=n(D(I(c,d),w,f),e.apply(this,_),a);at(i),u>0?K(this).transition().duration(u).call(M,b,w,i):K(this).call(v.transform,b,w,i)}}function k(i,..._){if(t.apply(this,arguments)){var c=i.touches,w=c.length,f=x(this,_,i.changedTouches.length===w).event(i),d,b,z,R;for(Et(i),b=0;b<w;++b)z=c[b],R=Z(z,this),R=[R,this.__zoom.invert(R),z.identifier],f.touch0?!f.touch1&&f.touch0[2]!==R[2]&&(f.touch1=R,f.taps=0):(f.touch0=R,d=!0,f.taps=1+!!y);y&&(y=clearTimeout(y)),d&&(f.taps<2&&(m=R[0],y=setTimeout(function(){y=null},T)),zt(this),f.start())}}function q(i,..._){if(this.__zooming){var c=x(this,_).event(i),w=i.changedTouches,f=w.length,d,b,z,R;for(at(i),d=0;d<f;++d)b=w[d],z=Z(b,this),c.touch0&&c.touch0[2]===b.identifier?c.touch0[0]=z:c.touch1&&c.touch1[2]===b.identifier&&(c.touch1[0]=z);if(b=c.that.__zoom,c.touch1){var L=c.touch0[0],X=c.touch0[1],j=c.touch1[0],B=c.touch1[1],O=(O=j[0]-L[0])*O+(O=j[1]-L[1])*O,U=(U=B[0]-X[0])*U+(U=B[1]-X[1])*U;b=I(b,Math.sqrt(O/U)),z=[(L[0]+j[0])/2,(L[1]+j[1])/2],R=[(X[0]+B[0])/2,(X[1]+B[1])/2]}else if(c.touch0)z=c.touch0[0],R=c.touch0[1];else return;c.zoom("touch",n(D(b,z,R),c.extent,a))}}function Y(i,..._){if(this.__zooming){var c=x(this,_).event(i),w=i.changedTouches,f=w.length,d,b;for(Et(i),p&&clearTimeout(p),p=setTimeout(function(){p=null},T),d=0;d<f;++d)b=w[d],c.touch0&&c.touch0[2]===b.identifier?delete c.touch0:c.touch1&&c.touch1[2]===b.identifier&&delete c.touch1;if(c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0)c.touch0[1]=this.__zoom.invert(c.touch0[0]);else if(c.end(),c.taps===2&&(b=Z(b,this),Math.hypot(m[0]-b[0],m[1]-b[1])<S)){var z=K(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return v.wheelDelta=function(i){return arguments.length?(r=typeof i=="function"?i:gt(+i),v):r},v.filter=function(i){return arguments.length?(t=typeof i=="function"?i:gt(!!i),v):t},v.touchable=function(i){return arguments.length?(s=typeof i=="function"?i:gt(!!i),v):s},v.extent=function(i){return arguments.length?(e=typeof i=="function"?i:gt([[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]]),v):e},v.scaleExtent=function(i){return arguments.length?(l[0]=+i[0],l[1]=+i[1],v):[l[0],l[1]]},v.translateExtent=function(i){return arguments.length?(a[0][0]=+i[0][0],a[1][0]=+i[1][0],a[0][1]=+i[0][1],a[1][1]=+i[1][1],v):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},v.constrain=function(i){return arguments.length?(n=i,v):n},v.duration=function(i){return arguments.length?(u=+i,v):u},v.interpolate=function(i){return arguments.length?(h=i,v):h},v.on=function(){var i=o.on.apply(o,arguments);return i===o?v:i},v.clickDistance=function(i){return arguments.length?(N=(i=+i)*i,v):Math.sqrt(N)},v.tapDistance=function(i){return arguments.length?(S=+i,v):S},v}var Un=lt('<svg tabindex="0"></svg> <div class="tooltip svelte-bz4dsi"></div>',1);function Bn(t,e){ue(e,!1);let n=mt(e,"dataUrl",12),r=mt(e,"width",8,800),s=mt(e,"height",8,600),l=mt(e,"onSelect",8,()=>{}),a=Q(),u=Q(),h=[],o=new Set,y=Ft,m,p,T=null,g=!1;ie(async()=>{h=await(await fetch(n())).json(),S()});const N=async M=>{n(M),h=await(await fetch(n())).json(),S()};function S(){const M=K(E(a)).attr("width",r()).attr("height",s()).style("user-select","none"),x=Yt().domain([0,1]).range([40,r()-40]),P=Yt().domain([0,1]).range([s()-40,40]),C=M.append("g"),$=Ln().filter(f=>f.type==="wheel"||f.altKey).scaleExtent([.5,10]).on("zoom",f=>{y=f.transform,C.attr("transform",y)});M.call($);const F=C.selectAll("circle").data(h).join("circle").attr("cx",f=>x(f.x)).attr("cy",f=>P(f.y)).attr("r",f=>4+f.size*10).attr("fill",f=>f.cluster===-1?"#999":Xn[f.cluster%10]).attr("stroke","#000").attr("stroke-width",.5).style("cursor","pointer").on("click",(f,d)=>{f.stopPropagation(),!g&&(f.shiftKey||i(),q(d,f.currentTarget),l()([...o]))}).on("mouseenter",_).on("mousemove",c).on("mouseleave",w);M.on("click",()=>{g||(i(),l()([...o]))}),E(a).addEventListener("keydown",f=>{f.key==="Escape"&&(i(),l()([...o])),(f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="a"&&(f.preventDefault(),i(),F.each(function(d){const b=y.applyX(x(d.x)),z=y.applyY(P(d.y));b>=0&&b<=r()&&z>=0&&z<=s()&&k(d,this)}),l()([...o]))});function k(f,d){o.has(f)||(o.add(f),K(d).attr("stroke","red").attr("stroke-width",2))}function q(f,d){o.has(f)?Y(f,d):k(f,d)}function Y(f,d){o.delete(f),K(d).attr("stroke","#000").attr("stroke-width",.5)}function i(){o.clear(),F.attr("stroke","#000").attr("stroke-width",.5)}function _(f,d){clearTimeout(m),ot(u,E(u).style.opacity="1"),ot(u,E(u).innerHTML=`<strong>${d.word}</strong><br/>Count:${d.count}<br/>Cluster:${d.cluster}`),c(f)}function c(f){ot(u,E(u).style.left=f.clientX+12+"px"),ot(u,E(u).style.top=f.clientY+12+"px")}function w(){m=setTimeout(()=>{ot(u,E(u).style.opacity="0")},250)}p=M.append("rect").attr("fill","rgba(0,120,255,0.25)").attr("stroke","#0078ff").attr("display","none").node(),M.on("pointerdown",f=>{f.altKey||(T=[f.offsetX,f.offsetY],g=!1,K(p).attr("x",T[0]).attr("y",T[1]).attr("width",0).attr("height",0).attr("display","block"))}),M.on("pointermove",f=>{if(!T)return;g=!0;const[d,b]=T,z=f.offsetX,R=f.offsetY;K(p).attr("x",Math.min(d,z)).attr("y",Math.min(b,R)).attr("width",Math.abs(z-d)).attr("height",Math.abs(R-b))}),M.on("pointerup",f=>{if(!T)return;const[d,b]=T,z=f.offsetX,R=f.offsetY,L=Math.min(d,z),X=Math.max(d,z),j=Math.min(b,R),B=Math.max(b,R);F.each(function(O){const U=y.applyX(x(O.x)),et=y.applyY(P(O.y));L<=U&&U<=X&&j<=et&&et<=B&&k(O,this)}),K(p).attr("display","none"),T=null,l()([...o])})}var v={update_data:N};re();var I=Un(),D=Ae(I);At(D,M=>tt(a,M),()=>E(a));var A=J(D,2);return At(A,M=>tt(u,M),()=>E(u)),ut(t,I),Ce(e,"update_data",N),se(v)}var Gn=lt('<li class="svelte-ks0b0f"> </li>'),Hn=lt('<li class="items_list_element svelte-ks0b0f"><a target="_blank" class="svelte-ks0b0f"> </a></li>'),Qn=lt('<li class="inspection_element svelte-ks0b0f"><h3 class="svelte-ks0b0f"> </h3> <div class="items_list svelte-ks0b0f"></div></li>'),Wn=lt('<div class="main_wrapper svelte-ks0b0f"><div class="scatter_wrapper svelte-ks0b0f"><!></div> <div class="controls_row svelte-ks0b0f"><div class="control_wrapper cw_l svelte-ks0b0f"><h2 class="svelte-ks0b0f">Selection</h2> <p class="svelte-ks0b0f"> </p> <ul class="svelte-ks0b0f"></ul></div> <div class="control_wrapper cw_r svelte-ks0b0f"><h2 class="svelte-ks0b0f">Inspection</h2> <ul class="svelte-ks0b0f"></ul></div></div></div>');function fr(t,e){ue(e,!1);let n=Q([]),r={},s=Q(),l=Q(""),a=Q("IIIF SOTA");u();function u(){if(E(l)!=""){let M=E(l).split("/data/iiif-sota/")[1].split("-embeddings.json")[0].split("_"),x="";M.forEach(P=>{x=x+P.toUpperCase()+" "}),tt(a,"IIIF SOTA | "+String(x))}}ie(async()=>{r=qe(),console.log("Params:",r),r.plot&&(tt(l,r.plot),await E(s).update_data(E(l)),u())});let h=Q([]);async function o(A){tt(h,A),tt(n,[]),E(h).forEach(M=>{M.uuids.forEach(x=>{E(n).includes(x)==!1&&E(n).push(x)})}),console.log(E(n))}re();var y=Wn();Pe("ks0b0f",A=>{Ie(()=>{De.title=E(a)??""})});var m=G(y),p=G(m);At(Bn(p,{get dataUrl(){return E(l)},onSelect:o,$$legacy:!0}),A=>tt(s,A),()=>E(s)),V(m);var T=J(m,2),g=G(T),N=J(G(g),2),S=G(N);V(N);var v=J(N,2);St(v,5,()=>E(h),Tt,(A,M)=>{var x=Gn(),P=G(x);V(x),ft(()=>ht(P,`- ${E(M).word??""} (count: ${E(M).count??""})`)),ut(A,x)}),V(v),V(g);var I=J(g,2),D=J(G(I),2);St(D,5,()=>E(h),Tt,(A,M)=>{var x=Qn(),P=G(x),C=G(P);V(P);var $=J(P,2);St($,5,()=>E(M).manifest_urls,Tt,(F,k)=>{var q=Hn(),Y=G(q),i=G(Y,!0);V(Y),V(q),ft(()=>{Re(Y,"href",E(k).url),ht(i,E(k).label)}),ut(F,q)}),V($),V(x),ft(()=>ht(C,`${E(M).word??""} (${E(M).count??""})`)),ut(A,x)}),V(D),V(I),V(T),V(y),ft(()=>ht(S,`Number of unique selected items: ${E(n).length??""}`)),ut(t,y),se()}export{fr as component,cr as universal};
